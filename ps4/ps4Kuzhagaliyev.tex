\documentclass[10pt,letter]{article}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{setspace}
\onehalfspacing
\usepackage{fullpage}
\newcommand{\R}{\mathbb{R}}	
\newcommand{\inner}{\langle\cdot,\cdot\rangle}
\newcommand{\inr}[2]{\langle #1, #2\rangle}
\newcommand\norm[1]{\left\lVert#1\right\rVert}

\begin{document}


\title{ACM104 Problem Set \#4 Solutions}

\author{Timur Kuzhagaliyev}

%\date{3rd November, 2017}
 
\maketitle 

\section*{Problem 1}

\begin{align*}
A &=
\left[ {\begin{array}{ccc}
 1 &  2 & -1 \\
 0 &  -2 & 3 \\
 1 &  5 & -1 \\
 -3 &  1 & 1 \\
\end{array} } \right]
\qquad \textrm{and} \qquad
b = 
\left[ {\begin{array}{c}
 0 \\
 5 \\
 6 \\
 8 \\
\end{array} } \right]
\end{align*}
\begin{align*}
p(x) = \norm{Ax-b}^2 &= x^T (A^T A) x - 2\ x^T (A^T b) + \norm{b}^2
\\ &= x^T K x - 2 x f + c 
\end{align*}
\begin{align*}
K = A^T \cdot A &=
\left[ {\begin{array}{cccc}
 1 &  0 & 1 & -3 \\
 2 &  -2 & 5 & 1 \\
 -1 &  3 & -1 & 1 \\
\end{array} } \right]
\left[ {\begin{array}{ccc}
 1 &  2 & -1 \\
 0 &  -2 & 3 \\
 1 &  5 & -1 \\
 -3 &  1 & 1 \\
\end{array} } \right]
=
\left[ {\begin{array}{ccc}
 11 & 4  & -5 \\
 4 & 34  & -12 \\
 -5 & -12  & 12 \\
\end{array} } \right]
\\\\ f = A^T b &= 
\left[ {\begin{array}{ccc}
 1 &  2 & -1 \\
 0 &  -2 & 3 \\
 1 &  5 & -1 \\
 -3 &  1 & 1 \\
\end{array} } \right]
\left[ {\begin{array}{c}
 0 \\
 5 \\
 6 \\
 8 \\
\end{array} } \right]
=
\left[ {\begin{array}{c}
 -18 \\
 28 \\
 17 \\
\end{array} } \right]
\end{align*}
First we need to check if the matrix $K$ is positive definite. We know that matrix is positive definite if all of its principal minors are positive. Indeed, $\textrm{det}\,A_1 = 11 > 0$; $\textrm{det}\,A_2 = 11 \cdot 34 - 4^2 = 18 > 0$; $\textrm{det}\,A_3 = 11 \cdot 264 - 4 \cdot (-12) - 5 \cdot 122 = 2904 + 48 - 610 = 2342 > 0$; Therefore $K$ is positive definite and there exists a global minimizer $x^* = K^{-1}f$.

\pagebreak

\begin{align*}
x^* = K^{-1} f = K f &=
\left[ {\begin{array}{ccc}
 11 & 4  & -5 \\
 4 & 34  & -12 \\
 -5 & -12  & 12 \\
\end{array} } \right]
\left[ {\begin{array}{c}
 -18 \\
 28 \\
 17 \\
\end{array} } \right]
\\ &= \frac{1}{2342}
\left[ {\begin{array}{ccc}
 264 & 12 & 122 \\
 12 & 107 & 112 \\
 122 & 112  & 358 \\
\end{array} } \right]
\left[ {\begin{array}{c}
 -18 \\
 28 \\
 17 \\
\end{array} } \right]
\\ &=
\left[ {\begin{array}{c}
 -1 \\
 2 \\
 3 \\
\end{array} } \right]
\quad \textrm{(solution)}
\\ \textrm{LSE} = \sqrt{\norm{b}^2 - b^T A x^*} &= \sqrt{\sqrt{125}^2 - 125}
\\ &= 0\\
\end{align*}

The least squares error is $0$, so in this case $x^*$ is the exact solution.

\section*{Problem 2}

\textit{WIP}

\section*{Problem 3}
\begin{gather*}
y = f(x_1, x_2) = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \beta_3 x_1 x_2
\quad \textrm{and} \quad
\beta^* = (\beta^*_0, \beta^*_1, \beta^*_2, \beta^*_3)^T
\end{gather*}

\paragraph{a)} Deriving a system of normal equations on $\beta^*$:

\begin{equation*}
\begin{aligned}[c]
r_i &= y^{(i)} - f(x_1^{(i)}, x_2^{(i)})
\\ &= y^{(i)} - 
\left[ {\begin{array}{cccc}
 1 & x_1^{(i)} & x_2^{(i)} & x_1^{(i)} x_2^{(i)} \\
\end{array} } \right]
\left[ {\begin{array}{c}
\beta^*_0 \\
\beta^*_1 \\
\beta^*_2 \\
\beta^*_3 \\
\end{array} } \right]
\end{aligned}
\qquad\Rightarrow\qquad
\begin{aligned}[c]
r &=  
\left[ {\begin{array}{c}
y^{(1)} \\
y^{(2)} \\
\vdots \\
\vdots \\
y^{(m)} \\
\end{array} } \right]
-
\left[ {\begin{array}{cccc}
 1 & x_1^{(1)} & x_2^{(1)} & x_1^{(1)} x_2^{(1)} \\
 1 & x_1^{(2)} & x_2^{(2)} & x_1^{(2)} x_2^{(2)} \\
 \vdots & \vdots & \vdots & \vdots \\
 \vdots & \vdots & \vdots & \vdots \\
 1 & x_1^{(m)} & x_2^{(m)} & x_1^{(m)} x_2^{(m)} \\
\end{array} } \right]
\left[ {\begin{array}{c}
\beta^*_0 \\
\beta^*_1 \\
\beta^*_2 \\
\beta^*_3 \\
\end{array} } \right]
\end{aligned}
\end{equation*}

See attached \texttt{ps4problem3Kuzhagaliyev.m} file and plots for other solutions.

\section*{Problem 4}

See attached \texttt{ps4problem4Kuzhagaliyev.m} file and plot for solutions.

\section*{Problem 5}

See attached \texttt{ps4problem5Kuzhagaliyev.m} and plot for solution.

\end{document}